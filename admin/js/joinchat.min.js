!function(v){"use strict";function f(){v(this).height(0).height(this.scrollHeight)}function b(t){return t.replace(/^0+|\D/,"").replace(/^54(0|1|2|3|4|5|6|7|8)/,"549$1").replace(/^(54\d{5})15(\d{6})/,"$1$2").replace(/^52(0|2|3|4|5|6|7|8|9)/,"521$1")}window.intl_tel_input_version=window.intlTelConf&&intlTelConf.version,v(function(){var n,t,o,e,i,a,c,h,l,s,r,u,_,g="function"==typeof intlTelInput;function p(t,e){var n;t=t||"all",e=e||v('input[name="joinchat[view]['+t+']"]:checked').val(),v(".view_inheritance_"+t).toggleClass("dashicons-visibility","yes"==e).toggleClass("dashicons-hidden","no"==e),"cpts"==t?v("[class*=view_inheritance_cpt_]").toggleClass("dashicons-visibility","yes"==e).toggleClass("dashicons-hidden","no"==e):t in h&&(n=""===(n=v('input[name="joinchat[view]['+t+']"]:checked').val())?e:n,v.each(h[t],function(){p(this,n)}))}function d(){s.has_chatbox=r||u}function j(){_&&s.has_chatbox?s.chatbox_show():s.chatbox_hide()}function m(){var t=tinymce.get("joinchat_optin_text").getContent(),e=v("#joinchat_optin_check")[0].checked;u=""!=t,d(),s.$div.toggleClass("joinchat--optout",""!=t&&e),""==t?s.$(".joinchat__optin").html(""):(t=t.replaceAll("<p>","").replaceAll("</p>","<br><br>").replace(/<br><br>$/,""),t=e?'<label for="joinchat_optin">'+t+"</label>":"<span>"+t+"</span>",s.$(".joinchat__optin").html('<input type="checkbox" id="joinchat_optin">'+t),s.$("#joinchat_optin").on("change",function(){s.$div.toggleClass("joinchat--optout",!this.checked)})),j()}g&&v("#joinchat_phone").length&&(t=JSON.parse(localStorage.joinchat_country_code||"{}"),o=!(!t.code||t.date!=(new Date).toDateString())&&t.code,e=v("#joinchat_phone"),i=""===e.val()?e.attr("placeholder"):null,e.removeAttr("placeholder"),(a=intlTelInput(e[0],{hiddenInput:e.data("name")||"joinchat[telephone]",separateDialCode:!0,initialCountry:"auto",preferredCountries:[o||""],geoIpLookup:function(e){o?e(o):v.getJSON("https://ipinfo.io").always(function(t){t=t&&t.country?t.country:"";localStorage.joinchat_country_code=JSON.stringify({code:t,date:(new Date).toDateString()}),e(t)})},customPlaceholder:function(t){return intlTelConf.placeholder+" "+t},utilsScript:intlTelConf.utils_js})).hiddenInput.value=e.val(),"string"==typeof i&&""!=i&&a.promise.then(function(){a.setNumber(i),e.attr("placeholder",a.getNumber(intlTelInputUtils.numberFormat.NATIONAL)).val("")}),e.on("input countrychange",function(){var t=v(this),e=intlTelInputGlobals.getInstance(this);t.css("color",t.val().trim()&&!e.isValidNumber()?"#ca4a1f":""),e.hiddenInput.value=e.getNumber(),v("#joinchat_phone_test").attr("disabled",!e.isValidNumber())}).on("blur",function(){var t=intlTelInputGlobals.getInstance(this);t.setNumber(t.getNumber())})),1===v("#joinchat_form").length&&(v(".nav-tab").on("click",function(t){t.preventDefault();var t=v(this),e=t.attr("href"),n=v("input[name=_wp_http_referer]"),o=n.val();n.val(o.substr(0,o.indexOf("page=joinchat"))+"page=joinchat&tab="+e.substr(14)),v(".nav-tab").removeClass("nav-tab-active").attr("aria-selected","false"),t.addClass("nav-tab-active").attr("aria-selected","true").get(0).blur(),v(".joinchat-tab").removeClass("joinchat-tab-active"),v(e).addClass("joinchat-tab-active"),v(document).trigger("navtabchange",[v(e),e])}),v(document).on("navtabchange",function(t,e){e.find("textarea").each(f)}),v("#joinchat_phone").length&&(g||v("#joinchat_phone").on("input change",function(){v("#joinchat_phone_test").attr("disabled",this.value.length<7)}),v("#joinchat_phone_test").on("click",function(){var t=g?intlTelInputGlobals.getInstance(v("#joinchat_phone")[0]).getNumber():v("#joinchat_phone").val();window.open("https://wa.me/"+encodeURIComponent(b(t)),"joinchat","noopener")})),v("#joinchat_mobile_only").on("change",function(){v("#joinchat_whatsapp_web, #joinchat_qr").closest("tr").toggleClass("joinchat-hidden",this.checked)}).trigger("change"),v("#joinchat_message_delay").on("change input",function(){v("#joinchat_message_badge, #joinchat_message_views").closest("tr").toggleClass("joinchat-hidden","0"==this.value)}).trigger("change"),v(".joinchat-show-help").on("click",function(t){t.preventDefault();t=v(this).attr("href");v("#contextual-help-wrap").is(":visible")?v("html, body").animate({scrollTop:0}):v("#contextual-help-link").trigger("click"),v("#"!=t?t:"#tab-link-styles-and-vars").find("a").trigger("click")}),v("textarea","#joinchat_form").on("focus",function(){v(this).closest("tr").addClass("joinchat--focus")}).on("blur",function(){v(this).closest("tr").removeClass("joinchat--focus")}).on("input",f).each(f),v("#joinchat_form").find(".autofill").on("change",function(){this.title=""==this.value?joinchat_admin.example:""}).on("dblclick",function(){""==this.value&&(this.value=this.placeholder,this.title="",v(this).trigger("change"))}).trigger("change"),c=v("#joinchat_tab_visibility"),h=v(".joinchat_view_all").data("inheritance")||{all:["front_page","blog_page","404_page","search","archive","singular","cpts"],archive:["date","author"],singular:["page","post"]},v("input",c).on("change",function(){p()}),v(".joinchat_view_reset").on("click",function(t){t.preventDefault(),v('input[value=""]',c).prop("checked",!0),v(".joinchat_view_all input",c).first().prop("checked",!0),p()}),p(),v("#joinchat_button_image_add").on("click",function(t){t.preventDefault(),n||((n=wp.media({title:v(this).data("title")||"Select button image",button:{text:v(this).data("button")||"Use Image"},library:{type:"image"},multiple:!1})).on("select",function(){var t=n.state().get("selection").first().toJSON(),e=t.sizes&&t.sizes.thumbnail&&t.sizes.thumbnail.url||t.url;v("#joinchat_button_image_holder").css({"background-size":"cover","background-image":"url("+e+")"}),v("#joinchat_button_image").val(t.id),v("#joinchat_button_image_remove").removeClass("joinchat-hidden"),s&&s.$(".joinchat__button__image").html('<img src="'+e+'">')}),n.on("open",function(){var t=wp.media.attachment(v("#joinchat_button_image").val());n.state().get("selection").add(t?[t]:[])})),n.open()}),v("#joinchat_button_image_remove").on("click",function(t){t.preventDefault(),v("#joinchat_button_image_holder").removeAttr("style"),v("#joinchat_button_image").val(""),v(this).addClass("joinchat-hidden"),s&&s.$(".joinchat__button__image").html("")}),v("#joinchat_color").wpColorPicker(),v("#joinchat_header_custom").on("click",function(){v(this).prev().find("input").prop("checked",!0)}),v('label[for="joinchat_optin_text"]').on("click",function(){tinymce.get("joinchat_optin_text").focus()}),v("#joinchat_message_text").on("change",function(){v(".joinchat__chat_open__wrapper").toggleClass("joinchat-hidden",""==this.value.trim())}).trigger("change"),v("#joinchat_woo_btn_position").on("change",function(){v("#joinchat_woo_btn_text").closest("tr").toggleClass("joinchat-hidden","none"==v(this).val())}).trigger("change"),l=wp.codeEditor.initialize(v("#joinchat_custom_css"),custom_css_settings),v(document).on("navtabchange",function(t,e,n){"#joinchat_tab_advanced"==n&&l.codemirror.refresh()}),v('label[for="joinchat_custom_css"]').on("click",function(){l.codemirror.focus()}),s=null,_=!(u=r=!1),v("#joinchat_preview_show").on("click",function(t){t.preventDefault();var e,n,o,t=v(this).hasClass("active");function i(t){t.preventDefault();t=(e-t.clientX)*(o?-1:1);document.documentElement.style.setProperty("--preview-width",Math.min(Math.max(n+t,300),600)+"px")}function a(t){t.preventDefault(),v("body").removeClass("jcpreview-resize").off("mousemove mouseup",i).off("mouseup mouseleave",a)}v(this).toggleClass("active",!t),v("body").toggleClass("jcpreview",!t),t||0!=v("#joinchatprev").length||(v("#wpwrap").append('<div id="joinchatprev"><div id="joinchatprev__resize"></div><iframe id="joinchat_preview" src="http://joinchat.local/?joinchat-preview" scrolling="no"></iframe></div>'),v("#joinchat_preview").on("load",function(){var t;s=this.contentWindow.joinchat_obj,r=""!=v("#joinchat_message_text").val().trim(),u=""!=tinymce.get("joinchat_optin_text").getContent(),d(),v("#joinchat_phone").on("change",function(){s.settings.telephone=b(g?intlTelInputGlobals.getInstance(this).getNumber():v(this).val()),s.$div.toggleClass("joinchat--disabled",""==s.settings.telephone)}),v("#joinchat_message_send").on("change",function(){s.settings.message_send=v(this).val()}),v("#joinchat_mobile_only").on("change",function(){s.$div.toggleClass("joinchat--mobile_only",this.checked)}),v("#joinchat_button_tip").on("focus blur",function(t){"focus"==t.type&&s.chatbox_hide(),s.$(".joinchat__tooltip").toggleClass("joinchat--show","focus"==t.type)}).on("input change",function(){s.$(".joinchat__tooltip").toggleClass("joinchat--hidden",""==v(this).val().trim()),s.$(".joinchat__tooltip div").text(v(this).val())}),v('input[name="joinchat[position]"]').on("change",function(){s.$div.toggleClass("joinchat--right","right"==this.value).toggleClass("joinchat--left","left"==this.value)}),v('#joinchat_message_text,#joinchat_message_start,input[name="joinchat[dark_mode]"],input[name="joinchat[header]"],#joinchat_header_custom').on("focus",j),v("#joinchat_message_text").on("input change",function(t){r=""!=v(this).val().trim(),d(),s.$(".joinchat__message").html(v(this).val().trim().replaceAll("\n","<br>")),j()}),v("#joinchat_message_start").on("input change",function(t){s.$(".joinchat__button__sendtext").text(v(this).val().trim()),j()}),v("#joinchat_color").wpColorPicker("option","change",function(t,e){var e=e.color.toRgb(),n=s.$div.get(0).style;n.setProperty("--red",e.r),n.setProperty("--green",e.g),n.setProperty("--blue",e.b),j()}),v('input[name="joinchat[dark_mode]"]').on("change",function(){s.$div.toggleClass("joinchat--dark","yes"==this.value).toggleClass("joinchat--dark-auto","auto"==this.value),j()}),v('input[name="joinchat[header]"]').on("change",function(){s.$(".joinchat__powered").toggleClass("joinchat--hidden","__jc__"!=this.value),s.$(".joinchat__wa ").toggleClass("joinchat--hidden","__wa__"!=this.value),s.$(".joinchat__header__text").toggleClass("joinchat--hidden","__custom__"!=this.value),j()}),v("#joinchat_header_custom").on("input change",function(){s.$(".joinchat__header__text").text(v(this).val()),j()}),v("#joinchat_message_badge").on("change",function(){s.settings.message_badge=this.checked,r&&(this.checked?s.chatbox_hide():s.chatbox_show(),s.$(".joinchat__badge").toggleClass("joinchat__badge--in",this.checked))}),tinymce.get("joinchat_optin_text").on("change",m),v("#joinchat_optin_check").on("change",m),l.codemirror.on("change",function(t){v("#joinchat_preview")[0].contentDocument.getElementById("joinchat-inline-css").innerHTML=t.getValue()}),_=!1,v("#joinchat_tab_general").find('input[type="text"],input[type="number"],input[type="checkbox"],input[type="radio"]:checked,textarea').trigger("change"),v("#joinchat_color").wpColorPicker("color",v("#joinchat_color").val()),t=l.codemirror.getValue(),l.codemirror.setValue(t+" "),l.codemirror.setValue(t),_=!0}),o=0<v("[dir=rtl]").length,v("#joinchatprev__resize").on("mousedown",function(t){t.preventDefault(),e=t.clientX,n=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--preview-width")),v("body").addClass("jcpreview-resize").on("mousemove mouseup",i).on("mouseup mouseleave",a)}))})),v(".joinchat-metabox").length&&v(".joinchat-metabox textarea").on("focus input",f).each(f)})}(jQuery);