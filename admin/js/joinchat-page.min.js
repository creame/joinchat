((m,v)=>{function f(){m(this).height(0).height(this.scrollHeight)}function b(t){return t.replace(/^0+|\D/,"").replace(/^54(0|1|2|3|4|5|6|7|8)/,"549$1").replace(/^(54\d{5})15(\d{6})/,"$1$2").replace(/^52(0|2|3|4|5|6|7|8|9)/,"521$1")}m(function(){var n,t,i,e,o,a,c="function"==typeof intlTelInput,h=(c&&m("#joinchat_phone").length&&(t=JSON.parse(localStorage.joinchat_country_code||"{}"),i=!(!t.code||t.date!=(new Date).toDateString())&&t.code,e=m("#joinchat_phone"),o=""===e.val()?e.attr("placeholder"):null,e.removeAttr("placeholder"),(a=intlTelInput(e[0],{hiddenInput:e.data("name")||"joinchat[telephone]",separateDialCode:!0,initialCountry:"auto",preferredCountries:[i||""],geoIpLookup:function(e){i?e(i):m.getJSON("https://ipinfo.io").always(function(t){t=t&&t.country?t.country:"";localStorage.joinchat_country_code=JSON.stringify({code:t,date:(new Date).toDateString()}),e(t)})},customPlaceholder:function(t){return intlTelConf.placeholder+" "+t},utilsScript:intlTelConf.utils_js})).hiddenInput.value=e.val(),"string"==typeof o&&""!=o&&a.promise.then(function(){a.setNumber(o),e.attr("placeholder",a.getNumber(intlTelInputUtils.numberFormat.NATIONAL)).val("")}),e.on("input countrychange",function(){var t=m(this),e=intlTelInputGlobals.getInstance(this);t.css("color",t.val().trim()&&!e.isValidNumber()?"#ca4a1f":""),e.hiddenInput.value=e.getNumber(),m("#joinchat_phone_test").attr("disabled",!e.isValidNumber())}).on("blur",function(){var t=intlTelInputGlobals.getInstance(this);t.setNumber(t.getNumber())})),m(".nav-tab").on("click",function(t){t.preventDefault();var t=m(this),e=t.attr("href"),n=m("input[name=_wp_http_referer]"),i=n.val();n.val(i.substr(0,i.indexOf("page=joinchat"))+"page=joinchat&tab="+e.substr(14)),m(".nav-tab").removeClass("nav-tab-active").attr("aria-selected","false"),t.addClass("nav-tab-active").attr("aria-selected","true").get(0).blur(),m(".joinchat-tab").removeClass("joinchat-tab-active"),m(e).addClass("joinchat-tab-active"),m(v).trigger("navtabchange",[m(e),e])}),m(v).on("navtabchange",function(t,e){e.find("textarea").each(f)}),m("#joinchat_phone").length&&(c||m("#joinchat_phone").on("input change",function(){m("#joinchat_phone_test").attr("disabled",this.value.length<7)}),m("#joinchat_phone_test").on("click",function(){var t=c?intlTelInputGlobals.getInstance(m("#joinchat_phone")[0]).getNumber():m("#joinchat_phone").val();window.open("https://wa.me/"+encodeURIComponent(b(t)),"joinchat","noopener")})),m("#joinchat_mobile_only").on("change",function(){m("#joinchat_whatsapp_web").closest("tr").toggleClass("joinchat-dimmed",this.checked)}).trigger("change"),m('input[name="joinchat[header]"]').on("change",function(){m("#joinchat_header_custom").toggleClass("joinchat-dimmed","__custom__"!=this.value)}).trigger("change"),m("#joinchat_message_delay_on").on("change",function(){m("#joinchat_message_delay, #joinchat_message_views, #joinchat_message_badge").parent().toggleClass("joinchat-dimmed",!this.checked),m(".joinchat-cookies-notice").toggleClass("joinchat-hidden",!this.checked)}).trigger("change"),m(".joinchat-show-help").on("click",function(t){t.preventDefault();t=m(this).attr("href");m("#contextual-help-wrap").is(":visible")?m("html, body").animate({scrollTop:0}):m("#contextual-help-link").trigger("click"),m("#"!=t?t:"#tab-link-styles-and-vars").find("a").trigger("click")}),m("textarea","#joinchat_form").on("focus",function(){m(this).closest("tr").addClass("joinchat--focus")}).on("blur",function(){m(this).closest("tr").removeClass("joinchat--focus")}).on("input",f).each(f),m("#joinchat_form").find(".autofill").on("change",function(){this.title=""==this.value?joinchat_admin.example:""}).on("dblclick",function(){""==this.value&&(this.value=this.placeholder,this.title="",m(this).trigger("change"))}).trigger("change"),m("#joinchat_tab_visibility")),s=m(".joinchat_view_all").data("inheritance")||{all:["front_page","blog_page","404_page","search","archive","singular","cpts"],archive:["date","author"],singular:["page","post"]};function l(t,e){var n;t=t||"all",e=e||m('input[name="joinchat[view]['+t+']"]:checked').val(),m(".view_inheritance_"+t).toggleClass("dashicons-visibility","yes"==e).toggleClass("dashicons-hidden","no"==e),"cpts"==t?m("[class*=view_inheritance_cpt_]").toggleClass("dashicons-visibility","yes"==e).toggleClass("dashicons-hidden","no"==e):t in s&&(n=""===(n=m('input[name="joinchat[view]['+t+']"]:checked').val())?e:n,m.each(s[t],function(){l(this,n)}))}m("input",h).on("change",function(){l()}),m(".joinchat_view_reset").on("click",function(t){t.preventDefault(),m('input[value=""]',h).prop("checked",!0),m(".joinchat_view_all input",h).first().prop("checked",!0),l()}),l(),m("#joinchat_button_image_add").on("click",function(t){t.preventDefault(),n||((n=wp.media({title:m(this).data("title")||"Select button image",button:{text:m(this).data("button")||"Use Image"},library:{type:"image,video"},multiple:!1})).on("select",function(){var t=n.state().get("selection").first().toJSON(),e=t.sizes&&t.sizes.thumbnail&&t.sizes.thumbnail.url||t.url,e="video"==t.type?'<video autoplay loop muted playsinline src="'+e+'"></video>':'<img src="'+e+'">';m("#joinchat_button_image_holder").html(e),m("#joinchat_button_image").val(t.id),m("#joinchat_button_image_remove").removeClass("joinchat-hidden"),_&&_.$(".joinchat__button__image").html(e)}),n.on("open",function(){var t=wp.media.attachment(m("#joinchat_button_image").val());n.state().get("selection").add(t?[t]:[])})),n.open()}),m("#joinchat_button_image_remove").on("click",function(t){t.preventDefault(),m("#joinchat_button_image_holder").empty(),m("#joinchat_button_image").val(""),m(this).addClass("joinchat-hidden"),_&&_.$(".joinchat__button__image").empty()}),m("#joinchat_color").wpColorPicker({change:function(t,e){m(this).trigger("changecolor",[e.color.toRgb()])}}),m("#joinchat_header_custom").on("click",function(){m(this).prev().find("input").trigger("click")}),m('label[for="joinchat_optin_text"]').on("click",function(){tinymce.get("joinchat_optin_text").focus()}),m("#joinchat_woo_btn_position").on("change",function(){m("#joinchat_woo_btn_text").closest("tr").toggleClass("joinchat-hidden","none"==m(this).val())}).trigger("change");var r=wp.codeEditor.initialize(m("#joinchat_custom_css"),custom_css_settings),_=(m(v).on("navtabchange",function(t,e,n){"#joinchat_tab_advanced"==n&&r.codemirror.refresh()}),m('label[for="joinchat_custom_css"]').on("click",function(){r.codemirror.focus()}),m(".joinchat_custom_css_prefill").on("click",function(t){t.preventDefault(),r.codemirror.setValue(joinchat_admin.example_css)}),m(v).on("navtabchange",function(t,e,n){"#joinchat_tab_general"==n||"#joinchat_tab_advanced"==n?m("#joinchat_preview_show").removeClass("disabled"):(m("body").removeClass("jcpreview"),m("#joinchat_preview_show").addClass("disabled").removeClass("active"))}),null),u=!0;function g(t){if(null==t)return parseInt(getComputedStyle(v.documentElement).getPropertyValue("--preview-width"));v.documentElement.style.setProperty("--preview-width",Math.min(Math.max(t,300),600)+"px")}function d(){_.has_chatbox=_.has_cta||_.has_optin,_.$div.toggleClass("joinchat--btn",!_.has_chatbox)}function p(){u&&_.has_chatbox?_.chatbox_show():_.chatbox_hide()}function j(){var t=tinymce.get("joinchat_optin_text").getContent(),e=m("#joinchat_optin_check")[0].checked;_.has_optin=""!=t,d(),_.$div.toggleClass("joinchat--optout",""!=t&&e),""==t?_.$(".joinchat__optin").html(""):(t=t.replaceAll("<p>","").replaceAll("</p>","<br><br>").replace(/<br><br>$/,""),t=e?'<label for="joinchat_optin">'+t+"</label>":"<span>"+t+"</span>",_.$(".joinchat__optin").html('<input type="checkbox" id="joinchat_optin">'+t),_.$("#joinchat_optin").on("change",function(){_.$div.toggleClass("joinchat--optout",!this.checked)})),p()}m("#joinchat_preview_show").on("click",function(t){var e,n,i;function o(t){t.preventDefault(),g(n+(e-t.clientX)*i)}function a(t){t.preventDefault(),m("body").removeClass("jcpreview-resize").off("mousemove mouseup",o).off("mouseup mouseleave",a)}t.preventDefault(),m(this).hasClass("disabled")||(t=m(this).hasClass("active"),m(this).toggleClass("active",!t),m("body").toggleClass("jcpreview",!t),t)||0!=m("#joinchatprev").length||(m("#wpwrap").append('<div id="joinchatprev"><div id="joinchatprev__resize"></div><iframe id="joinchat_preview" src="'+joinchat_admin.home+'?joinchat-preview=1" scrolling="no"></iframe></div>'),m("#joinchat_preview").on("load",function(){(_=this.contentWindow.joinchat_obj).has_cta=""!=m("#joinchat_message_text").val().trim(),_.has_optin=""!=tinymce.get("joinchat_optin_text").getContent(),m(v).trigger("preview",[this,_])}),i=0<m("[dir=rtl]").length?-1:1,m("#joinchatprev__resize").on("mousedown",function(t){t.preventDefault(),e=t.clientX,n=g(),m("body").addClass("jcpreview-resize").on("mousemove mouseup",o).on("mouseup mouseleave",a)}))}),m(v).on("preview",function(){d(),m("#joinchat_phone").on("change",function(){_.settings.telephone=b(c?intlTelInputGlobals.getInstance(this).getNumber():m(this).val()),_.$div.toggleClass("joinchat--disabled",""==_.settings.telephone)}),m("#joinchat_message_send").on("change",function(){_.settings.message_send=m(this).val()}),m("#joinchat_mobile_only").on("change",function(){_.$div.toggleClass("joinchat--mobile_only",this.checked)}),m("#joinchat_button_tip").on("focus blur",function(t){"focus"==t.type&&_.chatbox_hide(),_.$(".joinchat__tooltip").toggleClass("joinchat--show","focus"==t.type)}).on("input change",function(){_.$(".joinchat__tooltip").toggleClass("joinchat--hidden",""==m(this).val().trim()),_.$(".joinchat__tooltip div").text(m(this).val())}),m('input[name="joinchat[position]"]').on("change",function(){_.$div.toggleClass("joinchat--right","right"==this.value).toggleClass("joinchat--left","left"==this.value)}),m("#joinchat_qr").on("change",function(){clearTimeout(t),m("#joinchat_mobile_only")[0].checked||(this.checked&&(_.$(".joinchat__qr canvas").remove(),_.$(".joinchat__qr").append(_.qr(_.whatsapp_link(void 0,void 0,!1)))),u&&this.checked&&g()<=480&&g(481),u&&this.checked&&_.has_chatbox&&_.chatbox_show(),u&&(_.$(".joinchat__qr").toggleClass("joinchat--show",this.checked),t=setTimeout(function(){_.$(".joinchat__qr").removeClass("joinchat--show")},5e3)))}),m('#joinchat_message_text,#joinchat_message_start,input[name="joinchat[color][text]"],input[name="joinchat[dark_mode]"],input[name="joinchat[header]"],#joinchat_header_custom').on("focus",p),m("#joinchat_message_text").on("input change",function(t){_.has_cta=""!=m(this).val().trim(),d(),_.update_cta(m(this).val().trim()),p()}),m("#joinchat_message_start").on("input change",function(t){_.$(".joinchat__button__sendtext").text(m(this).val().trim()),p()}),m("#joinchat_color").on("changecolor",function(t,e){var n=_.$div.get(0).style;n.setProperty("--red",e.r),n.setProperty("--green",e.g),n.setProperty("--blue",e.b),p()}),m('input[name="joinchat[color][text]"]').on("change",function(){_.$div.get(0).style.setProperty("--bw",this.value),p()}),m('input[name="joinchat[dark_mode]"]').on("change",function(){_.$div.toggleClass("joinchat--dark","yes"==this.value).toggleClass("joinchat--dark-auto","auto"==this.value),p()}),m('input[name="joinchat[header]"]').on("change",function(){_.$(".joinchat__powered").toggleClass("joinchat--hidden","__jc__"!=this.value),_.$(".joinchat__wa ").toggleClass("joinchat--hidden","__wa__"!=this.value),_.$(".joinchat__header__text").toggleClass("joinchat--hidden","__custom__"!=this.value),p()}),m("#joinchat_header_custom").on("input change",function(){_.$(".joinchat__header__text").text(m(this).val()),p()}),m("#joinchat_message_badge").on("change",function(){_.settings.message_badge=this.checked,_.has_cta&&(this.checked?_.chatbox_hide():_.chatbox_show(),_.$(".joinchat__badge").toggleClass("joinchat__badge--in",this.checked))}),tinymce.get("joinchat_optin_text").on("change",j),m("#joinchat_optin_check").on("change",j),r.codemirror.on("change",function(t){m("#joinchat_preview")[0].contentDocument.getElementById("joinchat-inline-css").innerHTML=t.getValue().replace(/(<([^>]+)>)/gi,"")}),u=!1,m("#joinchat_tab_general").find('input[type="text"],input[type="number"],input[type="checkbox"],input[type="radio"]:checked,textarea').trigger("change"),m("#joinchat_color").wpColorPicker("color",m("#joinchat_color").val());var t,e=r.codemirror.getValue();r.codemirror.setValue(e+" "),r.codemirror.setValue(e),u=!0}),m(".nav-tab-active").trigger("click")})})(jQuery,document);