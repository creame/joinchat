!function(g,c,h,a){"use strict";var n;a=g.extend({settings:null,is_mobile:!!navigator.userAgent.match(/Android|iPhone|BlackBerry|IEMobile|Opera Mini/i),can_qr:c.QrCreator&&"function"==typeof QrCreator.render},a),(c.joinchat_obj=a).send_event=function(t){if((t=g.extend({event_category:"JoinChat",event_label:"",event_action:"",chat_channel:"whatsapp",chat_id:"--",is_mobile:this.is_mobile?"yes":"no",page_location:location.href,page_title:h.title||"no title"},t)).event_label=t.event_label||t.link||"",t.event_action=t.event_action||t.chat_channel+": "+t.chat_id,delete t.link,!1!==g(h).triggerHandler("joinchat:event",[t])){var e=c[this.settings.data_layer]||c[c.gtm4wp_datalayer_name]||c.dataLayer,n=!1,a=!1,i=this.settings.ga_event||"generate_lead",s=g.extend({transport_type:"beacon"},t);if(delete s.page_location,delete s.page_title,g.each(s,function(t,e){"string"==typeof e&&(s[t]=e.substring(0,100))}),this.settings.gtag){if(c.google_tag_data&&google_tag_data.tidr&&google_tag_data.tidr.destination)for(var o in google_tag_data.tidr.destination)"G-"==o.substring(0,2)||"GT-"==o.substring(0,3)?gtag("event",i,g.extend({send_to:o},s)):"GTM-"==o.substring(0,4)?n=!0:"AW-"==o.substring(0,3)&&(a=!0)}else"function"==typeof gtag&&"object"==typeof e&&(e.forEach(function(t){"config"!=t[0]||!t[1]||"G-"!=t[1].substring(0,2)&&"GT-"!=t[1].substring(0,3)||gtag("event",i,g.extend({send_to:t[1]},s))}),a=n=!0);a&&this.settings.gads&&gtag("event","conversion",{send_to:this.settings.gads});var r=t.event_category;delete t.event_category,n&&"object"==typeof e&&e.push(g.extend({event:r},t)),"function"==typeof fbq&&fbq("trackCustom",r,t)}},a.whatsapp_link=function(t,e,n){return e=void 0!==e?e:this.settings.message_send||"",((n=void 0!==n?n:this.settings.whatsapp_web&&!this.is_mobile)?"https://web.whatsapp.com/send?phone=":"https://wa.me/")+encodeURIComponent(t||this.settings.telephone)+(e?(n?"&text=":"?text=")+encodeURIComponent(e):"")},a.open_whatsapp=function(t,e){t=t||this.settings.telephone,e=void 0!==e?e:this.settings.message_send||"";t={link:this.whatsapp_link(t,e),chat_channel:"whatsapp",chat_id:t,chat_message:e},e=new RegExp("^https?://(wa.me|(api|web|chat).whatsapp.com|"+location.hostname.replace(".",".")+")/.*","i");!1!==g(h).triggerHandler("joinchat:open",[t])&&(e.test(t.link)?(this.send_event(t),c.open(t.link,"joinchat","noopener")):console.error("Joinchat: the link doesn't seem safe, it must point to the current domain or whatsapp.com"))},a.qr=function(t,e){var n=h.createElement("CANVAS");return QrCreator.render(g.extend({text:t,radius:.4,background:"#FFF",size:200},a.settings.qr||{},e||{}),n),n},g(h).on("click",'.joinchat_open, .joinchat_app, a[href="#joinchat"], a[href="#whatsapp"]',function(t){t.preventDefault(),a.open_whatsapp(g(this).data("phone"),g(this).data("message"))}),a.can_qr&&!a.is_mobile?g(".joinchat-button__qr").each(function(){g(this).append(a.qr(a.whatsapp_link(g(this).data("phone"),g(this).data("message"),!1)))}):g(".wp-block-joinchat-button figure").remove(),a.settings&&void 0!==a.settings.sku&&(n=a.settings.message_send,g("form.variations_form").on("found_variation reset_data",function(t,e){e=e&&e.sku||a.settings.sku;a.settings.message_send=n.replace(/<sku>.*<\/sku>/g,e)}))}(jQuery,window,document,window.joinchat_obj||{});