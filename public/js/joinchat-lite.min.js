!function(o,s,r,a){"use strict";var n;a=o.extend({settings:null,is_mobile:!!navigator.userAgent.match(/Android|iPhone|BlackBerry|IEMobile|Opera Mini/i),can_qr:s.QrCreator&&"function"==typeof QrCreator.render},a),(s.joinchat_obj=a).send_event=function(n){var e,t,a,i;(n=o.extend({event_category:"JoinChat",event_label:"",event_action:"",chat_channel:"whatsapp",chat_id:"--",is_mobile:this.is_mobile?"yes":"no",page_location:location.href,page_title:r.title||"no title"},n)).event_label=n.event_label||n.link||"",n.event_action=n.event_action||n.chat_channel+": "+n.chat_id,delete n.link,!1!==o(r).triggerHandler("joinchat:event",[n])&&(i=s[this.settings.ga_tracker]||s.ga||s.__gaTracker,e=s[this.settings.data_layer]||s[s.gtm4wp_datalayer_name]||s.dataLayer,"function"==typeof i&&"function"==typeof i.getAll&&(i("set","transport","beacon"),i.getAll().forEach(function(e){e.send("event",n.event_category,n.event_action,n.event_label)})),o.each(n,function(e,t){n[e]="string"==typeof t?t.substring(0,100):t}),"function"==typeof gtag&&"object"==typeof e&&(t=this.settings.ga_event||"generate_lead",delete(a=o.extend({transport_type:"beacon"},n)).page_location,delete a.page_title,e.forEach(function(e){"config"==e[0]&&e[1]&&"G-"==e[1].substring(0,2)&&(a.send_to=e[1],gtag("event",t,a))}),this.settings.gads&&gtag("event","conversion",{send_to:this.settings.gads})),i=n.event_category,delete n.event_category,"object"==typeof e&&e.push(o.extend({event:i},n)),"function"==typeof fbq&&fbq("trackCustom",i,n))},a.whatsapp_link=function(e,t,n){return t=void 0!==t?t:this.settings.message_send||"",((n=void 0!==n?n:this.settings.whatsapp_web&&!this.is_mobile)?"https://web.whatsapp.com/send?phone=":"https://wa.me/")+encodeURIComponent(e||this.settings.telephone)+(t?(n?"&text=":"?text=")+encodeURIComponent(t):"")},a.open_whatsapp=function(e,t){e=e||this.settings.telephone,t=void 0!==t?t:this.settings.message_send||"";e={link:this.whatsapp_link(e,t),chat_channel:"whatsapp",chat_id:e,chat_message:t},t=new RegExp("^https?://(wa.me|(api|web|chat).whatsapp.com|"+location.hostname.replace(".",".")+")/.*","i");!1!==o(r).triggerHandler("joinchat:open",[e])&&(t.test(e.link)?(this.send_event(e),s.open(e.link,"joinchat","noopener")):console.error("Joinchat: the link doesn't seem safe, it must point to the current domain or whatsapp.com"))},a.qr=function(e,t){var n=r.createElement("CANVAS");return QrCreator.render(o.extend({text:e,radius:.4,background:"#FFF",size:200},a.settings.qr||{},t||{}),n),n},o(r).on("click",'.joinchat_open, .joinchat_app, a[href="#joinchat"], a[href="#whatsapp"]',function(e){e.preventDefault(),a.open_whatsapp(o(this).data("phone"),o(this).data("message"))}),a.can_qr&&!a.is_mobile?o(".joinchat-button__qr").each(function(){o(this).append(a.qr(a.whatsapp_link(o(this).data("phone"),o(this).data("message"),!1)))}):o(".wp-block-joinchat-button figure").remove(),a.settings&&void 0!==a.settings.sku&&(n=a.settings.message_send,o("form.variations_form").on("found_variation reset_data",function(e,t){t=t&&t.sku||a.settings.sku;a.settings.message_send=n.replace(/<sku>.*<\/sku>/g,t)}))}(jQuery,window,document,window.joinchat_obj||{});