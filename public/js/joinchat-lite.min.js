!function(h,c,g,a){"use strict";var n;a=h.extend({settings:null,is_mobile:!!navigator.userAgent.match(/Android|iPhone|BlackBerry|IEMobile|Opera Mini/i),can_qr:c.QrCreator&&"function"==typeof QrCreator.render},a),(c.joinchat_obj=a).send_event=function(t){if((t=h.extend({event_category:"JoinChat",event_label:"",event_action:"",chat_channel:"whatsapp",chat_id:"--",is_mobile:this.is_mobile?"yes":"no",page_location:location.href,page_title:g.title||"no title"},t)).event_label=t.event_label||t.link||"",t.event_action=t.event_action||t.chat_channel+": "+t.chat_id,delete t.link,!1!==h(g).triggerHandler("joinchat:event",[t])){var e=c[this.settings.data_layer]||c[c.gtm4wp_datalayer_name]||c.dataLayer;if("object"==typeof e){"undefined"==typeof gtag&&(c.gtag=function(){e.push(arguments)});var n=this.settings.ga_event||"generate_lead",a=h.extend({transport_type:"beacon"},t),i=(h.each(a,function(t,e){"page_location"==t?a[t]=e.substring(0,1e3):"page_referrer"==t?a[t]=e.substring(0,420):"page_title"==t?a[t]=e.substring(0,300):"string"==typeof e&&(a[t]=e.substring(0,100))}),[]),s=function(t){i.includes(t)||(t.startsWith("G-")||t.startsWith("GT-"))&&(i.push(t),gtag("event",n,h.extend({send_to:t},a)))};if(c.google_tag_data&&google_tag_data.tidr&&google_tag_data.tidr.destination)for(var o in google_tag_data.tidr.destination)s(o);e.forEach(function(t){"config"==t[0]&&t[1]&&s(t[1])}),this.settings.gads&&gtag("event","conversion",{send_to:this.settings.gads})}var r=t.event_category;delete t.event_category,"object"==typeof e&&e.push(h.extend({event:r},t)),"function"==typeof fbq&&fbq("trackCustom",r,t)}},a.whatsapp_link=function(t,e,n){return e=void 0!==e?e:this.settings.message_send||"",((n=void 0!==n?n:this.settings.whatsapp_web&&!this.is_mobile)?"https://web.whatsapp.com/send?phone=":"https://wa.me/")+encodeURIComponent(t||this.settings.telephone)+(e?(n?"&text=":"?text=")+encodeURIComponent(e):"")},a.open_whatsapp=function(t,e){t=t||this.settings.telephone,e=void 0!==e?e:this.settings.message_send||"";t={link:this.whatsapp_link(t,e),chat_channel:"whatsapp",chat_id:t,chat_message:e},e=new RegExp("^https?://(wa.me|(api|web|chat).whatsapp.com|"+location.hostname.replace(".",".")+")/.*","i");!1!==h(g).triggerHandler("joinchat:open",[t])&&(e.test(t.link)?(this.send_event(t),c.open(t.link,"joinchat","noopener")):console.error("Joinchat: the link doesn't seem safe, it must point to the current domain or whatsapp.com"))},a.qr=function(t,e){var n=g.createElement("CANVAS");return QrCreator.render(h.extend({text:t,radius:.4,background:"#FFF",size:200},a.settings.qr||{},e||{}),n),n},h(g).on("click",'.joinchat_open, .joinchat_app, a[href="#joinchat"], a[href="#whatsapp"]',function(t){t.preventDefault(),a.open_whatsapp(h(this).data("phone"),h(this).data("message"))}),a.can_qr&&!a.is_mobile?h(".joinchat-button__qr").each(function(){h(this).append(a.qr(a.whatsapp_link(h(this).data("phone"),h(this).data("message"),!1)))}):h(".wp-block-joinchat-button figure").remove(),a.settings&&void 0!==a.settings.sku&&(n=a.settings.message_send,h("form.variations_form").on("found_variation reset_data",function(t,e){e=e&&e.sku||a.settings.sku;a.settings.message_send=n.replace(/<sku>.*<\/sku>/g,e)}))}(jQuery,window,document,window.joinchat_obj||{});