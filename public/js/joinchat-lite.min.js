!function(r,g,c,a){"use strict";var n;a=r.extend({settings:null,is_mobile:!!navigator.userAgent.match(/Android|iPhone|BlackBerry|IEMobile|Opera Mini/i),can_qr:g.QrCreator&&"function"==typeof QrCreator.render},a),(g.joinchat_obj=a).send_event=function(t){if((t=r.extend({event_category:"JoinChat",event_label:"",event_action:"",chat_channel:"whatsapp",chat_id:"--",is_mobile:this.is_mobile?"yes":"no",page_location:location.href,page_title:c.title||"no title"},t)).event_label=t.event_label||t.link||"",t.event_action=t.event_action||t.chat_channel+": "+t.chat_id,delete t.link,!1!==r(c).triggerHandler("joinchat:event",[t])){var e=g[this.settings.data_layer]||g[g.gtm4wp_datalayer_name]||g.dataLayer,n=!1,a=!1,i=this.settings.ga_event||"generate_lead",s=r.extend({transport_type:"beacon"},t);if(delete s.page_location,delete s.page_title,r.each(s,function(t,e){"string"==typeof e&&(s[t]=e.substring(0,100))}),this.settings.gtag){if(g.google_tag_data&&google_tag_data.tidr&&google_tag_data.tidr.destination)for(const tag in google_tag_data.tidr.destination)"G-"==tag.substring(0,2)||"GT-"==tag.substring(0,3)?gtag("event",i,r.extend({send_to:tag},s)):"GTM-"==tag.substring(0,4)?n=!0:"AW-"==tag.substring(0,3)&&(a=!0)}else"function"==typeof gtag&&"object"==typeof e&&(e.forEach(function(t){"config"==t[0]&&t[1]&&"G-"==t[1].substring(0,2)&&gtag("event",i,r.extend({send_to:tag},s))}),a=n=!0);a&&this.settings.gads&&gtag("event","conversion",{send_to:this.settings.gads});var o=t.event_category;delete t.event_category,n&&"object"==typeof e&&e.push(r.extend({event:o},t)),"function"==typeof fbq&&fbq("trackCustom",o,t)}},a.whatsapp_link=function(t,e,n){return e=void 0!==e?e:this.settings.message_send||"",((n=void 0!==n?n:this.settings.whatsapp_web&&!this.is_mobile)?"https://web.whatsapp.com/send?phone=":"https://wa.me/")+encodeURIComponent(t||this.settings.telephone)+(e?(n?"&text=":"?text=")+encodeURIComponent(e):"")},a.open_whatsapp=function(t,e){t=t||this.settings.telephone,e=void 0!==e?e:this.settings.message_send||"";t={link:this.whatsapp_link(t,e),chat_channel:"whatsapp",chat_id:t,chat_message:e},e=new RegExp("^https?://(wa.me|(api|web|chat).whatsapp.com|"+location.hostname.replace(".",".")+")/.*","i");!1!==r(c).triggerHandler("joinchat:open",[t])&&(e.test(t.link)?(this.send_event(t),g.open(t.link,"joinchat","noopener")):console.error("Joinchat: the link doesn't seem safe, it must point to the current domain or whatsapp.com"))},a.qr=function(t,e){var n=c.createElement("CANVAS");return QrCreator.render(r.extend({text:t,radius:.4,background:"#FFF",size:200},a.settings.qr||{},e||{}),n),n},r(c).on("click",'.joinchat_open, .joinchat_app, a[href="#joinchat"], a[href="#whatsapp"]',function(t){t.preventDefault(),a.open_whatsapp(r(this).data("phone"),r(this).data("message"))}),a.can_qr&&!a.is_mobile?r(".joinchat-button__qr").each(function(){r(this).append(a.qr(a.whatsapp_link(r(this).data("phone"),r(this).data("message"),!1)))}):r(".wp-block-joinchat-button figure").remove(),a.settings&&void 0!==a.settings.sku&&(n=a.settings.message_send,r("form.variations_form").on("found_variation reset_data",function(t,e){e=e&&e.sku||a.settings.sku;a.settings.message_send=n.replace(/<sku>.*<\/sku>/g,e)}))}(jQuery,window,document,window.joinchat_obj||{});